
  // Author: Chris Ivie
  // Github: https://github.com/ChrisIvie
  // License: Apache 2.0


  //Loop through JSON files.. not the best way of doing this but it is what it is!
  for(var i=0;i<=900;i++)
  {

// HTTP request to open CVE JSON files      
var xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
    var data = $.parseJSON(this.response)
    //console.log(this.response)
    console.log(data)

    // Grabs the CVE number
    var node = document.createElement("div");  
    node.className = "badge badge-success";
    cveNum = data.cve.CVE_data_meta.ID;
    var textnode = document.createTextNode(cveNum);
    node.appendChild(textnode);
    //console.log(cveNum)
    document.getElementById("cve-num").appendChild(node)


    // Grabs the severity of CVE
    var node2 = document.createElement("span");
    sev = data.impact.baseMetricV3.cvssV3.baseSeverity;
    //console.log(sev)
    node2.className = "badge badge-primary"
    var textnode2 = document.createTextNode(sev);
    node2.appendChild(textnode2);
    document.getElementById("cve-num").appendChild(node2)

    // Grabs the Last Modified Date of CVE
    var node4 = document.createElement("div")
    node4.className = "badge badge-dark";
    lastMod = data.lastModifiedDate
    var textnode4 = document.createTextNode(lastMod);
    node4.appendChild(textnode4);
    document.getElementById("cve-num").appendChild(node4) 

    // Grabs the description of the CVE
    var node3 = document.createElement("div")
    node3.className = "alert alert-info";
    des = data.cve.description.description_data[0].value
    var textnode3 = document.createTextNode(des);
    node3.appendChild(textnode3);
    document.getElementById("cve-num").appendChild(node3)  

    //Grabs reference data
    var node5 = document.createElement("a")
    node5.className = "alert alert-dark";
    refdata = data.cve.references.reference_data[0].name
    var textnode5 = document.createTextNode(refdata);
    console.log()
    node5.appendChild(textnode5);
    //console.log(des);
    node5.href = refdata
    document.getElementById("cve-num").appendChild(node5) 
    

   
 



    sleep(10);

  }
};

function sleep(milliseconds) {
    const date = Date.now();
    let currentDate = null;
    do {
      currentDate = Date.now();
    } while (currentDate - date < milliseconds);
  }

  xmlhttp.open("GET", "json/"+ i +".json", true);
  //sleep(100);
  
  xmlhttp.send();
  }




